<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="모델에 데이터를 먹이는 방법
1. Dataset#모아놓은 데이터에 대해 Dataset이라는 클래스를 통해 시작, 길이, mapstyle 등을 선언해준다.
__getitems__() : 하나의 데이터를 불러올 때 어떤 식으로 데이터를 반환할 지를 선언해준다.
데이터 입력 형태를 정의하는 클래스
데이터를 입력하는 방식의 표준화
Image, Text, Audio 등에 따라 다르게 입력이 정의된다.
데이터의 형태에 따라 각 함수를 다르게 정의한다.
모든 것을 데이터 생성 시점에 처리할 필요는 없다.
image의 Tensor 변화는 학습에 필요한 시점에 변환해주면 된다.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="모델에 데이터를 먹이는 방법(PyTorch Datasets &amp; DataLoaders)" />
<meta property="og:description" content="모델에 데이터를 먹이는 방법
1. Dataset#모아놓은 데이터에 대해 Dataset이라는 클래스를 통해 시작, 길이, mapstyle 등을 선언해준다.
__getitems__() : 하나의 데이터를 불러올 때 어떤 식으로 데이터를 반환할 지를 선언해준다.
데이터 입력 형태를 정의하는 클래스
데이터를 입력하는 방식의 표준화
Image, Text, Audio 등에 따라 다르게 입력이 정의된다.
데이터의 형태에 따라 각 함수를 다르게 정의한다.
모든 것을 데이터 생성 시점에 처리할 필요는 없다.
image의 Tensor 변화는 학습에 필요한 시점에 변환해주면 된다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://osmin625.github.io/posts/2023-09-19-PyTorch-Datasets-DataLoaders/" /><meta property="article:section" content="posts" />

<meta property="article:modified_time" content="2024-01-10T01:07:46+09:00" />

<title>모델에 데이터를 먹이는 방법(PyTorch Datasets &amp; DataLoaders) | OMIN</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="stylesheet" href="/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css" integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz&#43;OQteg=" crossorigin="anonymous"><!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>OMIN</span>
  </a>
</h2>













  












  
<ul>
  
  <li>
    <a href="/posts/"  >
        Blog
      </a>
  </li>
  
  <li>
    <a href="https://github.com/osmin625/"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
    <label for="menu-control">
      <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
    </label>
  
    <strong>모델에 데이터를 먹이는 방법(PyTorch Datasets &amp; DataLoaders)</strong>
  
    <label for="toc-control">
      
      <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
      
    </label>
  </div>
  

  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1-dataset">1. Dataset</a></li>
            <li><a href="#2-transforms">2. Transforms</a></li>
            <li><a href="#3-dataloader">3. DataLoader</a></li>
            <li><a href="#4-model">4. Model</a></li>
            <li><a href="#예제">예제</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    <a href="/posts/2023-09-19-PyTorch-Datasets-DataLoaders/">모델에 데이터를 먹이는 방법(PyTorch Datasets &amp; DataLoaders)</a>
  </h1>
  


  
  <div>
    
      <a href="/categories/DL-Framework/">DL Framework</a>, 
      <a href="/categories/PyTorch/">PyTorch</a>
  </div>
  

  
  <div>
    
      <a href="/tags/Dataset/">Dataset</a>, 
      <a href="/tags/DataLoader/">DataLoader</a>, 
      <a href="/tags/PyTorch/">PyTorch</a>
  </div>
  



<p>모델에 데이터를 먹이는 방법</p>
<p>
  <img src="/imgs/dataset_dataloader.png" alt="dataset" /></p>
<h3 id="1-dataset">
  1. Dataset
  <a class="anchor" href="#1-dataset">#</a>
</h3>
<p>모아놓은 데이터에 대해 Dataset이라는 클래스를 통해 시작, 길이, mapstyle 등을 선언해준다.</p>
<p><code>__getitems__()</code> : 하나의 데이터를 불러올 때 어떤 식으로 데이터를 반환할 지를 선언해준다.</p>
<hr>
<p>데이터 입력 형태를 정의하는 클래스</p>
<p>데이터를 입력하는 방식의 표준화</p>
<p>Image, Text, Audio 등에 따라 다르게 입력이 정의된다.</p>
<p>데이터의 형태에 따라 각 함수를 다르게 정의한다.</p>
<p><strong>모든 것을 데이터 생성 시점에 처리할 필요는 없다.</strong></p>
<p>image의 Tensor 변화는 학습에 필요한 시점에 변환해주면 된다.</p>
<p>데이터 셋에 대한 표준화된 처리 방법 제공이 필요하다.</p>
<p>후속 연구자 또는 동료들에게는 빛과 같은 존재가 될 수 있다.</p>
<p>최근에는 HuggingFace 등 표준화된 라이브러리를 사용한다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> torch.utils.data <span style="color:#f92672">import</span> Dataset
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomDataset</span>(Dataset): 
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">def</span> __init__(self, text, labels): <span style="color:#75715e"># 초기 데이터 생성 방법을 지정</span>
</span></span><span style="display:flex;"><span>				self<span style="color:#f92672">.</span>labels <span style="color:#f92672">=</span> labels 
</span></span><span style="display:flex;"><span>				self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> text
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">def</span> __len__(self):
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>labels) <span style="color:#75715e"># 데이터의 전체 길이</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">def</span> __getitem__(self, idx): <span style="color:#75715e"># idx 값을 입력으로 받고, dict 타입으로 데이터를 반환해준다.</span>
</span></span><span style="display:flex;"><span>				label <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>labels[idx] <span style="color:#75715e"># 반환되는 데이터의 형태 (X,y)</span>
</span></span><span style="display:flex;"><span>				text <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>data[idx]
</span></span><span style="display:flex;"><span>				sample <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Text&#34;</span>: text, 
</span></span><span style="display:flex;"><span>				<span style="color:#e6db74">&#34;Class&#34;</span>: label} 
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> sample
</span></span></code></pre></div><h3 id="2-transforms">
  2. Transforms
  <a class="anchor" href="#2-transforms">#</a>
</h3>
<p>Data Augumentation 등의 동작을 수행한다.</p>
<p><code>ToTensor()</code> : 모아놓은 데이터를 Tensor로 변환해준다.</p>
<h3 id="3-dataloader">
  3. DataLoader
  <a class="anchor" href="#3-dataloader">#</a>
</h3>
<p>Data의 Batch를 생성해주는 클래스</p>
<p>정리된 데이터를 묶어서 모델에 넣어준다.</p>
<p>batch를 만들거나, shuffle 등의 역할을 수행한다.</p>
<p>학습 직전(GPU feed 전) 데이터의 변환을 책임진다.</p>
<p>Tensor로 변환 + Batch 처리가 메인 업무이다.</p>
<p>병렬적인 데이터 전처리 코드를 고민하게 된다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DataLoader(dataset, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, <span style="color:#f92672">**</span>sampler<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span><span style="color:#f92672">**</span>, 
</span></span><span style="display:flex;"><span>					 <span style="color:#f92672">**</span>batch_sampler<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span><span style="color:#f92672">**</span>, num_workers<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, collate_fn<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, 
</span></span><span style="display:flex;"><span>					 pin_memory<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, drop_last<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, 
</span></span><span style="display:flex;"><span>					 worker_init_fn<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, <span style="color:#f92672">*</span>, prefetch_factor<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, persistent_workers<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>sampler : Data를 어떻게 뽑을 지 index를 정해주는 기법</p>
<p><strong>collate_fn</strong> : [[data,label],[data,label]] 형태로 묶인 데이터를 [data,data],[label,label]로 바꿔준다.</p>
<p>흔하게 사용되지는 않는다.</p>
<ul>
<li>variable length(가변인자) 텍스트 처리에서 padding을 위해 많이 쓰인다.</li>
<li>Sequence형 데이터를 처리할 때도 많이 쓰인다.</li>
</ul>
<h3 id="4-model">
  4. Model
  <a class="anchor" href="#4-model">#</a>
</h3>
<hr>
<h3 id="예제">
  예제
  <a class="anchor" href="#%ec%98%88%ec%a0%9c">#</a>
</h3>
<p>
  <a href="https://pytorch.org/vision/stable/datasets.html#built-in-datasets">Datasets — Torchvision main documentation</a></p>
<p>
  <a href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html">Datasets &amp; DataLoaders — PyTorch Tutorials 2.0.1+cu117 documentation</a></p>
<ol>
<li>DataLoader에서 사용할 수 있는 각 sampler들을 언제 사용하면 좋을지 논의해보기</li>
<li>데이터의 크기가 너무 커서 메모리에 한번에 올릴 수 없을 때 Dataset에서 어떻게 데이터를 불러오는 것이 좋을지 논의해보기</li>
</ol>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1-dataset">1. Dataset</a></li>
            <li><a href="#2-transforms">2. Transforms</a></li>
            <li><a href="#3-dataloader">3. DataLoader</a></li>
            <li><a href="#4-model">4. Model</a></li>
            <li><a href="#예제">예제</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












